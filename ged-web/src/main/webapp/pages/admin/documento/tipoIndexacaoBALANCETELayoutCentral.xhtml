<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:p="http://primefaces.org/ui">

	<p:commandButton value="Novo Balancete" action="#{painelBalancete.preparaCadastro()}" rendered="#{!painelBalancete.renderedCadastro}"
		 icon="ui-icon-plus"></p:commandButton>
		 
 	<p:commandButton value="Pesquisar" action="#{painelBalancete.preparaPesquisar()}" rendered="#{!painelBalancete.renderedPesquisar}"
		 icon="ui-icon-search"></p:commandButton>
		 
	<p:commandButton value="Exportar" action="#{painelBalancete.preparaExportar()}" rendered="#{!painelBalancete.renderedExportar and painelBalancete.autorizaFuncionalidade('EXPORTAR_BALANCETE')}"
		 icon="ui-icon-plus" ></p:commandButton>
	
	<p:separator></p:separator>
		 
	<p:fieldset legend="Pesquisar"
		toggleable="true" toggleSpeed="500"
		rendered="#{painelBalancete.renderedPesquisar}">
		
		<h:panelGrid cellpadding="10" columns="4">

			<p:outputLabel value="Ano:"></p:outputLabel>
			<p:inputMask id="txtAno" mask="9999"
				value="#{painelBalancete.filtroBalanceteDTO.ano}" size="4">
				<p:ajax partialSubmit="true" process="@form"></p:ajax>
			</p:inputMask>

			<p:outputLabel value="Mês:"></p:outputLabel>
			<p:selectOneMenu id="mes"
				value="#{painelBalancete.filtroBalanceteDTO.mes}">

				<f:selectItem noSelectionOption="true" itemLabel="#{msg['MG03']}"></f:selectItem>
				<f:selectItems value="#{painelBalancete.filtroBalanceteDTO.listSelectItemMes}"></f:selectItems>
			</p:selectOneMenu>
			
			<p:outputLabel value="Órgão:"></p:outputLabel>
			<p:selectOneMenu id="orgao"
				value="#{painelBalancete.filtroBalanceteDTO.orgao}">

				<f:selectItem noSelectionOption="true" itemLabel="#{msg['MG03']}"></f:selectItem>
				<f:selectItems value="#{painelBalancete.filtroBalanceteDTO.listSelectItemOrgao}"></f:selectItems>
			</p:selectOneMenu>
			
			<p:outputLabel value="Volume:"></p:outputLabel>
			<p:inputText id="txtVolume"
				value="#{painelBalancete.filtroBalanceteDTO.volume}" size="6">
				<p:ajax partialSubmit="true" process="@form"></p:ajax>
			</p:inputText>
			
			<p:outputLabel value="Data da Indexação:"></p:outputLabel>
			<p:calendar value="#{painelBalancete.filtroBalanceteDTO.dataIndexacao}">
				<p:ajax partialSubmit="true" process="@form" event="dateSelect"
					global="false"></p:ajax>
			</p:calendar>
			
			<p:outputLabel value="Interessado:"></p:outputLabel>
			<p:inputText value="#{painelBalancete.usuarioLogado.pessoa.nome}"
				readonly="true" size="30">
				<p:ajax partialSubmit="true" process="@form" event="change"
					global="false"></p:ajax>
			</p:inputText>
			
			<p:outputLabel value="Observação:"></p:outputLabel>
			<p:inputTextarea value="#{painelBalancete.filtroBalanceteDTO.observacao}"
				style="width:200px">
				<p:ajax partialSubmit="true" process="@form" event="change"
					global="false"></p:ajax>
			</p:inputTextarea>
			
		</h:panelGrid>
		
		<p:separator></p:separator>

		<h:panelGrid style="margin:0 auto; text-align:center;">

			<p:commandButton value="Pesquisar" type="submit"
				action="#{painelBalancete.pesquisar}"></p:commandButton>

		</h:panelGrid>
		
	</p:fieldset>
	
	<p:fieldset legend="Cadastrar"
		toggleable="true" toggleSpeed="500"
		rendered="#{painelBalancete.renderedCadastro}">
		
		<ui:include src="/pages/admin/documento/balancete/cadastrarAlterarBalancete.xhtml">
			<ui:param name="painelBalancete" value="#{painelBalancete}"></ui:param>
		</ui:include>
		
		<p:separator></p:separator>
		
		<h:panelGrid style="margin:0 auto; text-align:center;">

			<p:commandButton value="Cadastrar" type="submit"
				action="#{painelBalancete.cadastrar}"></p:commandButton>

		</h:panelGrid>
		
	</p:fieldset>
	
	<p:fieldset legend="Alterar"
		toggleable="true" toggleSpeed="500"
		rendered="#{painelBalancete.renderedAlterar}">
		
		<ui:include src="/pages/admin/documento/balancete/cadastrarAlterarBalancete.xhtml">
			<ui:param name="painelBalancete" value="#{painelBalancete}"></ui:param>
		</ui:include>
		
		<p:separator></p:separator>
		
		<h:panelGrid style="margin:0 auto; text-align:center;">

			<p:commandButton value="Alterar" type="submit"
				action="#{painelBalancete.alterar}"></p:commandButton>

		</h:panelGrid>
		
	</p:fieldset>
	
	<p:fieldset legend="Exportar"
		toggleable="true" toggleSpeed="500"
		rendered="#{painelBalancete.renderedExportar}">
		
		<h:panelGrid columns="4" cellpadding="10">
			<p:outputLabel value="Período da inclusão do documento de:"
				for="calendaDeInclusaoExportar"></p:outputLabel>
			<p:calendar 
				value="#{painelBalancete.filtroBalanceteDTO.dataIndexacaoBetween.dataInicio}"></p:calendar>
			<p:outputLabel value="até:" for="calendarAteInclusaoExportar"></p:outputLabel>
			<p:calendar 
				value="#{painelBalancete.filtroBalanceteDTO.dataIndexacaoBetween.dataFim}"></p:calendar>
		</h:panelGrid>

		<p:separator></p:separator>

		<h:panelGrid style="margin:0 auto; text-align:center;">
			<p:commandButton ajax="false" title="Exportar"
				onclick="PrimeFaces.monitorDownload(start, stop);"
				icon="ui-icon-arrowthickstop-1-s" value="Exportar">
				<p:fileDownload value="#{painelBalancete.exportar()}" />
			</p:commandButton>
		</h:panelGrid>
		
	</p:fieldset>
	
	<p:panel id="listaBalancetes" header="Documentos Digitalizados"
		rendered="#{painelBalancete.renderedPesquisar}">

		<p:dataGrid var="doc" value="#{painelBalancete.listBalancete}"
			columns="3" layout="grid" rows="12" paginator="true" id="balancetes"
			emptyMessage="Nenhum documento digitalizado.">

			<p:panel header="#{doc.ano}" style="text-align:center">

				<h:panelGrid columns="1" style="width:100%">

					<p:remoteCommand name="rc" oncomplete="PF('docObservacao').show()">
						<f:setPropertyActionListener value="#{doc.observacao}"
							target="#{obsDocumento.observacaoDoc}"></f:setPropertyActionListener>
					</p:remoteCommand>

					<h:graphicImage ondblclick="rc()" alt="Arquivo PDF" id="iconPdf"
						value="icon/pdf.png" rendered="#{doc.arquivo.pdf}" />
					<h:graphicImage ondblclick="rc()" alt="Imagem" id="iconImagem"
						value="icon/imagem.png" rendered="#{doc.arquivo.imagem}" />
					<h:graphicImage ondblclick="rc()" alt="Imagem" id="iconWord"
						value="icon/word.png" rendered="#{doc.arquivo.word}" />

					<p:outputLabel value="#{doc.arquivo.descricao}"
						style="font-weight:bold"></p:outputLabel>

					<p:separator></p:separator>

					<h:outputText value="Mês: #{doc.mes}" />
					<h:outputText value="Volume: #{doc.volume}" />
					<h:outputText value="Data de Indexação: #{doc.dataIndexacaoFormat}"></h:outputText>
					<h:outputText value="Última Modificação: #{doc.dataUltimaAlteracaoFormat}"></h:outputText>
					<h:outputText value="Autor: #{doc.usuario.pessoa.nome}"></h:outputText>

					<h:panelGrid columns="4"
						style="width:50px;margin:0 auto; text-align:center;">

						<p:commandButton icon="ui-icon-search" title="Visualizar"
							oncomplete="PF('docView').show()"
							rendered="#{doc.arquivo.pdf and painelBalancete.autorizaFuncionalidade('VISUALIZAR_BALANCETE')}">
							<p:ajax event="click" listener="#{basicBalanceteViewerController.carregaStreamArquivo(doc.id)}"></p:ajax>
						</p:commandButton>

						<p:commandButton icon="ui-icon-search" title="Visualizar"
							oncomplete="PF('imagemView').show()"
							rendered="#{doc.arquivo.imagem and painelBalancete.autorizaFuncionalidade('VISUALIZAR_BALANCETE')}">
							<f:setPropertyActionListener value="#{doc.id}" target="#{basicDocumentViewerController.docId}"></f:setPropertyActionListener>
						</p:commandButton>

						<p:commandButton ajax="false" title="Download"
							onclick="PrimeFaces.monitorDownload(start, stop);"
							icon="ui-icon-arrowthickstop-1-s"
							rendered="#{painelBalancete.autorizaFuncionalidade('BAIXAR_BALANCETE')}">
							<f:setPropertyActionListener value="#{doc.id}"
								target="#{basicBalanceteViewerController.docId}"></f:setPropertyActionListener>
							<p:fileDownload
								value="#{basicBalanceteViewerController.streamedImageById}" />
						</p:commandButton>
						
						<p:commandButton icon="ui-icon-refresh" title="Alterar"
							action="#{painelBalancete.preparaAlterar(doc)}"
							rendered="#{painelBalancete.autorizaFuncionalidade('ALTERAR_BALANCETE')}" />

						<p:commandButton icon="ui-icon-trash" title="Remover"
							oncomplete="PF('confirmaExclusaoDoc').show()"
							rendered="#{painelBalancete.autorizaFuncionalidade('REMOVER_BALANCETE')}">
							<f:setPropertyActionListener value="#{doc}"
								target="#{painelBalancete.balancete}"></f:setPropertyActionListener>
						</p:commandButton>

					</h:panelGrid>
				</h:panelGrid>
			</p:panel>

		</p:dataGrid>
	</p:panel>
		 
	

</ui:composition>
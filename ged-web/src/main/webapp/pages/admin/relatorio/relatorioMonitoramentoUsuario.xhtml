<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
		      	xmlns:h="http://java.sun.com/jsf/html"
		      	xmlns:f="http://java.sun.com/jsf/core"
		      	xmlns:p="http://primefaces.org/ui"
		      	template="/pages/admin/templatePaginasAdmin.xhtml">

	<ui:define name="title">Relatório de Monitoramento de Usuários</ui:define>

	<ui:define name="body">
	
		<p:panel  header="Filtro da Pesquisa" style="margin:0 auto; width:80%; text-align:center;" >
		    
		    <h:panelGrid columns="2" cellpadding="10" style="margin:0 auto;" >

				<p:outputLabel for="nomeGrupoSelectOne" value="Nome do grupo:" />
		
				<p:selectOneMenu id="nomeGrupoSelectOne" value="#{painelRelatorioMonitoramento.idGrupoSelecionado}" panelStyle="width:180px"
                         effect="fade" style="width:160px">
                         
                    <p:ajax event="change" listener="#{painelRelatorioMonitoramento.carregaSelectItemsUsuario}" update="nomeUsuarioSelectOne"></p:ajax>
					
					<f:selectItem noSelectionOption="true" itemLabel="#{msg['MG03']}"></f:selectItem>                        
		            <f:selectItems value="#{painelRelatorioMonitoramento.selectItemsGrupoUsuario}"/>
		 
		        </p:selectOneMenu>
		        
		        <p:outputLabel for="nomeUsuarioSelectOne" value="Nome do usuário:" />
		
				<p:selectOneMenu id="nomeUsuarioSelectOne" value="#{painelRelatorioMonitoramento.idUsuarioSelecionado}" panelStyle="width:180px"
                         effect="fade" style="width:160px">
                         
                    <f:selectItem noSelectionOption="true" itemLabel="#{msg['MG03']}"></f:selectItem>      
		            <f:selectItems value="#{painelRelatorioMonitoramento.selectItemsUsuario}"/>
		 
		        </p:selectOneMenu>
		        
		        <p:outputLabel for="departamentoSelectOne" value="Departamento:" />
		
				<p:selectOneMenu id="departamentoSelectOne" value="#{painelRelatorioMonitoramento.departamentoSelecionado}" panelStyle="width:180px"
                         effect="fade" style="width:160px">
                         
                    <f:selectItem noSelectionOption="true" itemLabel="#{msg['MG03']}"></f:selectItem>      
		            <f:selectItems value="#{painelRelatorioMonitoramento.selectItemsDepartamento}"/>
		 
		        </p:selectOneMenu>

				<p:selectBooleanCheckbox itemLabel="Deste mês" label="Deste mês"
					value="#{painelRelatorioMonitoramento.periodoMesAtual}">

					<p:ajax partialSubmit="true" process="@form"></p:ajax>
				</p:selectBooleanCheckbox>
				
			</h:panelGrid>
		    
		    <h:panelGrid columns="3" cellpadding="10" style="margin:0 auto;">
		
				<p:commandButton id="btnPesquisar" value="Monitorar" 
					action="#{painelRelatorioMonitoramento.monitorar()}" update="@form" />
				<p:commandButton id="btnLimpar" value="#{msg['MG17']}" 
					action="#{painelRelatorioMonitoramento.inicio()}" update="@form" />
		
			</h:panelGrid>

			<p:separator style="margin:0 auto; width:80%; text-align:center;"></p:separator>
			
      	</p:panel>
		    
	    <p:panel style="margin:0 auto; width:80%; text-align:center;" header="#{painelRelatorioMonitoramento.departamentoSelecionado.label}">
	    	
	    	<div class="ui-g">
			    
			    <div class="ui-g-2">
			    
			    	<p:panel header="Inseridos">
			    	
				    	<h:outputText value="#{painelRelatorioMonitoramento.retornoMonitoramento.qntInseridos}" />
		    			<p:separator></p:separator>
		    			<p:commandButton value="Detalhar" action="#{painelRelatorioMonitoramento.detalhar('CADASTRADO')}" 
		    							rendered="#{painelRelatorioMonitoramento.retornoMonitoramento.qntInseridos > 0}" 
		    							update="@form" oncomplete="scrollFocus('form:j_id_2g')"></p:commandButton>
			    	</p:panel>
	    			
			    </div>
			    
			    <div class="ui-g-2">
			    	<p:panel header="Alterados">
		    			<h:outputText value="#{painelRelatorioMonitoramento.retornoMonitoramento.qntAlterados}" />
		    			<p:separator></p:separator>
		    			<p:commandButton value="Detalhar" action="#{painelRelatorioMonitoramento.detalhar('ALTERADO_PRE')}"  update="@form"
		    							rendered="#{painelRelatorioMonitoramento.retornoMonitoramento.qntAlterados > 0}"></p:commandButton>
	    			</p:panel>
			    </div>
			    
			    <div class="ui-g-2">
			    	<p:panel header="Excluidos">
		    			<h:outputText value="#{painelRelatorioMonitoramento.retornoMonitoramento.qntExcluidos}" />
		    			<p:separator></p:separator>
		    			<p:commandButton value="Detalhar" action="#{painelRelatorioMonitoramento.detalhar('EXCLUIDO')}"  update="@form"
		    							rendered="#{painelRelatorioMonitoramento.retornoMonitoramento.qntExcluidos > 0}"></p:commandButton>
	    			</p:panel>
			    </div>
			    
			    <div class="ui-g-2">
			    
			    	<p:panel header="Baixados">
		    			<h:outputText value="#{painelRelatorioMonitoramento.retornoMonitoramento.qntBaixados}" />
		    			<p:separator></p:separator>
		    			<p:commandButton value="Detalhar" action="#{painelRelatorioMonitoramento.detalhar('BAIXADO')}"  update="@form"
		    							rendered="#{painelRelatorioMonitoramento.retornoMonitoramento.qntBaixados > 0}"></p:commandButton>
	    			</p:panel>
    			</div>
    			
    			<div class="ui-g-2">
    				<p:panel header="Visualizados">
		    			<h:outputText value="#{painelRelatorioMonitoramento.retornoMonitoramento.qntVisualizados}" />
		    			<p:separator></p:separator>
		    			<p:commandButton value="Detalhar" action="#{painelRelatorioMonitoramento.detalhar('VISUALIZADO')}"  update="@form"
		    							rendered="#{painelRelatorioMonitoramento.retornoMonitoramento.qntVisualizados > 0}"></p:commandButton>
	    			</p:panel>
    			</div>
    			
    			<div class="ui-g-2">
					<p:panel header="Exportados">
		    			<h:outputText value="#{painelRelatorioMonitoramento.retornoMonitoramento.qntExportados}" />
		    			<p:separator></p:separator>
		    			<p:commandButton value="Detalhar" action="#{painelRelatorioMonitoramento.detalhar('EXPORTADO')}"  update="@form"
		    							rendered="#{painelRelatorioMonitoramento.retornoMonitoramento.qntExportados > 0}"></p:commandButton>
	    			</p:panel>
    			</div>
			</div>
	    </p:panel>

		<p:panel header="Detalhes da operação" rendered="#{painelRelatorioMonitoramento.renderedDetalhar}"
			style="margin:0 auto; width:80%; text-align:center;">

			<p:outputPanel autoUpdate="true">

				<p:dataTable var="balanc"
					value="#{painelRelatorioMonitoramento.listDetalheBalanceteAudit}">

					<p:column headerText="Tipo da Operação">
						<h:outputText value="#{balanc.id.tipoOperacaoAudit.label}"></h:outputText>
					</p:column>

					<p:column headerText="Data da operação">
						<h:outputText value="#{balanc.id.dataHoraFormat}">
						</h:outputText>
					</p:column>

					<p:column headerText="Órgão">
						<h:outputText value="#{balanc.orgao.label}">
						</h:outputText>
					</p:column>

					<p:column headerText="Data da indexação">
						<h:outputText value="#{balanc.dataIndexacaoFormat}">
						</h:outputText>
					</p:column>

					<p:column headerText="Mais informações">
						<p:commandButton value="Dossiê"
							oncomplete="PF('dossieBalancete').show()"
							rendered="#{!balanc.id.tipoOperacaoAudit.operacaoAlterar}">
							<f:setPropertyActionListener value="#{balanc}"
								target="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado}"></f:setPropertyActionListener>
						</p:commandButton>

						<p:commandButton value="Comparar"
							action="#{painelRelatorioMonitoramentoBalancete.preDossieAlteracao}"
							oncomplete="PF('dossieBalanceteAlterar').show()"
							rendered="#{balanc.id.tipoOperacaoAudit.operacaoAlterar}">
							<f:setPropertyActionListener value="#{balanc}"
								target="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado}"></f:setPropertyActionListener>
						</p:commandButton>
					</p:column>
				</p:dataTable>
			</p:outputPanel>
		</p:panel>

		<p:dialog header="Dossiê da operação" widgetVar="dossieBalancete"
			position="top" modal="true" showEffect="fade" hideEffect="fade"
			resizable="true"
			style="text-align:center !important; border:none !important;">

			<p:outputPanel autoUpdate="true">
			
				<p:separator></p:separator>
						
					<h:outputText value="Data da operação: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.id.dataHoraFormat}" />
						
				<p:separator></p:separator>
			
				<p:panel header="Ano: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.ano}" style="text-align:center">
				
					<h:panelGrid columns="1" style="width:100%">
	
						<h:graphicImage  alt="Arquivo PDF" 
							value="../documento/icon/pdf.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.arquivo.pdf}" />
						<h:graphicImage  alt="Imagem" 
							value="../documento/icon/imagem.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.arquivo.imagem}" />
						<h:graphicImage  alt="Imagem" 
							value="../documento/icon/word.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.arquivo.word}" />
	
						<p:outputLabel value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.arquivo.descricao}"
							style="font-weight:bold"></p:outputLabel>
	
						<p:separator></p:separator>
						
						<h:outputText value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.orgao.label}" />
						
						<p:separator></p:separator>
	
						<h:outputText value="Mês: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.mes.label}" />
						<h:outputText value="Volume: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.volume}" />
						<h:outputText value="Data de Indexação: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.dataIndexacaoFormat}"></h:outputText>
						<h:outputText value="Última Modificação: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.dataUltimaAlteracaoFormat}"></h:outputText>
						<h:outputText value="Autor: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.usuario.pessoa.nome}"></h:outputText>
						
						<p:separator></p:separator>
						<h:outputText value="Observação: "/>
						<p:inputTextarea value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.observacao}"
							style="width:200px" readonly="true"> 
						</p:inputTextarea>
	
						<h:panelGrid columns="1"
							style="width:50px;margin:0 auto; text-align:center;">
	
							<p:commandButton ajax="false" title="Download" value="Download"
								onclick="PrimeFaces.monitorDownload(start, stop);"
								icon="ui-icon-arrowthickstop-1-s">
								<f:setPropertyActionListener value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.id}" target="#{basicBalanceteAuditViewerController.balanceteAuditPK}"></f:setPropertyActionListener>
								<p:fileDownload	value="#{basicBalanceteAuditViewerController.streamedDownaload}" />
							</p:commandButton>
							
						</h:panelGrid>
					</h:panelGrid>
				</p:panel>
				
			</p:outputPanel>
	</p:dialog>
	
	<p:dialog header="Dossiê da alteração" widgetVar="dossieBalanceteAlterar"
			position="top" modal="true" showEffect="fade" hideEffect="fade"
			resizable="true"
			style="text-align:center !important; border:none !important;">

			<p:outputPanel autoUpdate="true">
			
				<p:separator></p:separator>
						
					<h:outputText value="Data da alteração: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionado.id.dataHoraFormat}" />
						
				<p:separator></p:separator>
			
				<div class="ui-g">
			    
				    <div class="ui-g-6">
				    
				    	<p:separator></p:separator>
						
							<h:outputText style="text-align:center" value="Antes" />
								
						<p:separator></p:separator>
				    
				    	<p:panel header="Ano: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.ano}" style="text-align:center">
			
							<h:panelGrid columns="1" style="width:100%">
			
								<h:graphicImage  alt="Arquivo PDF" 
									value="../documento/icon/pdf.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.arquivo.pdf}" />
								<h:graphicImage  alt="Imagem" 
									value="../documento/icon/imagem.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.arquivo.imagem}" />
								<h:graphicImage  alt="Imagem" 
									value="../documento/icon/word.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.arquivo.word}" />
			
								<p:outputLabel value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.arquivo.descricao}"
									style="font-weight:bold"></p:outputLabel>
			
								<p:separator></p:separator>
								
								<h:outputText value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.orgao.label}" />
								
								<p:separator></p:separator>
			
								<h:outputText value="Mês: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.mes.label}" />
								<h:outputText value="Volume: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.volume}" />
								<h:outputText value="Data de Indexação: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.dataIndexacaoFormat}"></h:outputText>
								<h:outputText value="Última Modificação: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.dataUltimaAlteracaoFormat}"></h:outputText>
								<h:outputText value="Autor: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.usuario.pessoa.nome}"></h:outputText>
								
								<p:separator></p:separator>
								<h:outputText value="Observação: "/>
								<p:inputTextarea value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.observacao}"
									style="width:200px" readonly="true"> 
								</p:inputTextarea>
			
								<h:panelGrid columns="1"
									style="width:50px;margin:0 auto; text-align:center;">
			
									<p:commandButton ajax="false" title="Download" value="Download"
										onclick="PrimeFaces.monitorDownload(start, stop);"
										icon="ui-icon-arrowthickstop-1-s">
										<f:setPropertyActionListener value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPreAlteracao.id}" target="#{basicBalanceteAuditViewerController.balanceteAuditPK}"></f:setPropertyActionListener>
										<p:fileDownload	value="#{basicBalanceteAuditViewerController.streamedDownaload}" />
									</p:commandButton>
									
								</h:panelGrid>
							</h:panelGrid>
						</p:panel>				
				    </div>
				    
				    <div class="ui-g-6">
				    
				    	<p:separator></p:separator>
						
							<h:outputText style="text-align:center" value="Depois" />
								
						<p:separator></p:separator>
				    
				    	<p:panel header="Ano: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.ano}" style="text-align:center">
			
							<h:panelGrid columns="1" style="width:100%">
			
								<h:graphicImage  alt="Arquivo PDF" 
									value="../documento/icon/pdf.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.arquivo.pdf}" />
								<h:graphicImage  alt="Imagem" 
									value="../documento/icon/imagem.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.arquivo.imagem}" />
								<h:graphicImage  alt="Imagem" 
									value="../documento/icon/word.png" rendered="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.arquivo.word}" />
			
								<p:outputLabel value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.arquivo.descricao}"
									style="font-weight:bold"></p:outputLabel>
			
								<p:separator></p:separator>
								
								<h:outputText value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.orgao.label}" />
								
								<p:separator></p:separator>
			
								<h:outputText value="Mês: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.mes.label}" />
								<h:outputText value="Volume: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.volume}" />
								<h:outputText value="Data de Indexação: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.dataIndexacaoFormat}"></h:outputText>
								<h:outputText value="Última Modificação: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.dataUltimaAlteracaoFormat}"></h:outputText>
								<h:outputText value="Autor: #{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.usuario.pessoa.nome}"></h:outputText>
								
								<p:separator></p:separator>
								<h:outputText value="Observação: "/>
								<p:inputTextarea value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.observacao}"
									style="width:200px" readonly="true"> 
								</p:inputTextarea>
			
								<h:panelGrid columns="1"
									style="width:50px;margin:0 auto; text-align:center;">
			
									<p:commandButton ajax="false" title="Download" value="Download"
										onclick="PrimeFaces.monitorDownload(start, stop);"
										icon="ui-icon-arrowthickstop-1-s">
										<f:setPropertyActionListener value="#{painelRelatorioMonitoramentoBalancete.balanceteSelecionadoPosAlteracao.id}" target="#{basicBalanceteAuditViewerController.balanceteAuditPK}"></f:setPropertyActionListener>
										<p:fileDownload	value="#{basicBalanceteAuditViewerController.streamedDownaload}" />
									</p:commandButton>
									
								</h:panelGrid>
							</h:panelGrid>
						</p:panel>		
				    </div>
			    
			    </div>
			
			</p:outputPanel>
	</p:dialog>

	</ui:define>
</ui:composition>